SELECT CAR_ID, "대여 가능" AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE CAR_ID NOT IN (SELECT CAR_ID
FROM (SELECT CAR_ID, CASE WHEN START_DATE <= "2022-10-16" AND "2022-10-16" <= END_DATE THEN "대여중" ELSE "대여 가능" END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY) AS T1
WHERE AVAILABILITY = "대여중")

UNION

SELECT CAR_ID, AVAILABILITY
FROM (SELECT CAR_ID, CASE WHEN START_DATE <= "2022-10-16" AND "2022-10-16" <= END_DATE THEN "대여중" ELSE "대여 가능" END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY) AS T1
WHERE AVAILABILITY = "대여중"

ORDER BY CAR_ID DESC

# 자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기